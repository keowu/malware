"""
 _   __ _____ _____  _    _ _   _
| | / /|  ___|  _  || |  | | | | |
| |/ / | |__ | | | || |  | | | | |
|    \ |  __|| | | || |/\| | | | |
| |\  \| |___\ \_/ /\  /\  / |_| |
\_| \_/\____/ \___/  \/  \/ \___/
                            2023
Copyright (c) Fluxuss Cyber Tech Desenvolvimento de Software, SLU (FLUXUSS)
Copyright (c) Fluxuss Software Security, LLC

Binary files
"""

import gzip
import base64
import json
import decrypt_malware_c2_server


def execute():
    message = open("bruh.txt", "rb").read()

    a = base64.b64decode(message)

    s = gzip.decompress(a)

    dict_new = json.loads(decrypt_malware_c2_server.execute()["PCRT"])

    a = s.decode('utf-8')

    for c in enumerate(dict_new.items()):
        a = a.replace(c[1][1], c[1][0])

    s = base64.b64decode(a[::-1]).decode('utf-8')

    print("Dropped New FIle: " + s)

    new_json_dict = json.loads(s)

    dropped_new_malware = base64.b64decode(new_json_dict['0'][0])

    with open("out.bin", "wb") as f:
        f.write(dropped_new_malware)

    f.close()

    print("IDK_not_used: " + new_json_dict["1"])
