"""
 _   __ _____ _____  _    _ _   _
| | / /|  ___|  _  || |  | | | | |
| |/ / | |__ | | | || |  | | | | |
|    \ |  __|| | | || |/\| | | | |
| |\  \| |___\ \_/ /\  /\  / |_| |
\_| \_/\____/ \___/  \/  \/ \___/
                            2023
Copyright (c) Fluxuss Cyber Tech Desenvolvimento de Software, SLU (FLUXUSS)
Copyright (c) Fluxuss Software Security, LLC

DECODE CONFIG FILE C2(COMMAND AND CONTROL SERVER)
"""
import base64
import gzip
import json
import decrypt_master_config_file


def execute():
    message = 'H4sIAAAAAAAEAA3OzQqDIAAA4FdZaGKSEkSnIopZg27VVrd+Zg21gafFCOnZt+8JvjiuXyrX5CTXTnmK6KWYw5I+R5kx50vXWb5bYMq+mni9P6z44Js4pIUH1gPCx+AVGdwNF0HjzMpoAvBGUgKYI7NFRvRuhqxJXdszd/Nn2bVJHsCpstBcQoEi4CPGRyS4LxMAz9xZAkn/l9YnFVh/5g0xvJwAAAA='

    a = base64.b64decode(message.encode('utf-8'))

    s = gzip.decompress(a)

    dict_new = json.loads(decrypt_master_config_file.execute()["SCRT"])

    a = s.decode('utf-8')

    for c in enumerate(dict_new.items()):
        a = a.replace(c[1][1], c[1][0])

    print("[ ! ] CONFIG_FILE_C2_DCRAT: " + base64.b64decode(a[::-1]).decode('utf-8'))
